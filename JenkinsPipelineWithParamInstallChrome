pipeline {
    agent any

    parameters {
        // Choice parameter to select the target host
        choice(
            name: 'TARGET_HOST',
            choices: ['zorrinnodes', 'troubleshooting', 'subnetscan'], // Replace with your inventory hosts
            description: 'Select the target host to run the playbook'
        )
    }

    environment {
        REPO_URL = 'https://github.com/jrbanua/ansible.git' // Replace with your GitHub repository URL
        PLAYBOOK = 'install-google-chrome.yml'                                      // Replace with your playbook name
        INVENTORY = 'hosts.ini'                                    // Replace with your inventory file name
    }

    stages {
        stage('Checkout Code') {
            steps {
                // Clone the GitHub repository
                git branch: 'main', url: env.REPO_URL
            }
        }

        stage('Run Ansible Playbook') {
            steps {
                // Run the Ansible playbook
                ansiColor('xterm') {
                    sh """
                    ansible-playbook ${env.PLAYBOOK} \
                    -i ${env.INVENTORY} \
                    --limit ${params.TARGET_HOST}
                    """
                }
            }
        }
    }
}
